# Changelog

本文档记录了 0.23 中协作、开发、部署、测试以及平台管理等功能的增加、优化和BUG修复记录。

# 基础功能

### [0.23.0] - 2020-10-12

## 新增功能 

* 平台首页新增工作台功能，支持查看用户在所有项目下的待办问题、待审核任务、项目最近更新文档、项目与个人快速链接以及最近访问的应用服务与环境
* 项目层新增项目概览
* 平台层新增平台开发者的预定义角色，支持该角色查看操作平台层事务、任务以及API相关的菜单
* 项目列表中新增星标收藏项目的功能，支持在首页工作台中快速进入星标项目

## 缺陷修复

* 修复了组织层-客户端添加角色，页面无反应的问题
* 修复了组织层-客户端分配角色时能选择已停用角色的问题
* 修复了组织层Logo修改后未生效的问题
* 修复了“用户管理-修改用户”与“个人信息-修改信息”中，14开头手机校验失败的问题
* 修复了更新用户角色时去掉所有角色, GitLab未同步的问题
* 修复了平台管理-消息日志”中，过滤表搜索报错的问题
* 修复了接收设置页面中过滤表搜索栏，搜索过滤无效果的问题
* 修复了企业微信类型的webhook在Webhook记录中显示偶现为JSON类型的问题
* 修复了webhook记录详情中的”消息内容“模块为空的问题
* 修复了asgard服务的事务刷新不进去的问题

# 功能优化

* 优化完善了平台的安全性相关的模块，提高了平台的安全性
* 优化了个人中心-接收设置界面卡顿的问题
* 优化了修改用户界面手机号为必填的问题
* 优化了项目列表中，各项目栏内项目名称的可点击范围太大从而引起误触的问题
## 移除

* 移除了“组织层-管理中心-仓库”界面中Docker仓库配置的入口

# 敏捷协作 

### [0.23.0] - 2020-10-12

## 功能优化

### 工作列表

* 优化所有问题一键展开。
* 优化工作列表筛选。

# 代码开发 

### [0.23.0] - 2020-10-12

## 新增功能

* 流水线中新增CD属性的阶段，支持在其中添加CD类型的任务，如：部署、主机部署、人工卡点。
* 流水线中新增支持“正则匹配”、“精确匹配”、“精确排除”的触发分支匹配方式。
* 流水线中新增“上传jar包至制品库”的步骤，支持将同一任务中构建生成的jar包上传至指定的目标制品库。
* 流水线中新增“Maven发布”的步骤，支持构建工件并上传至项目下指定的目标制品库。
* 流水线-CI阶段-mvn构建步骤-setting配置部分，新增支持选择项目下已有的依赖库。
* 流水线-CI阶段-代码检查类型的任务中新增SonarQube的默认配置。
* 流水线中新增CI变量配置的功能，支持项目所有者在此配置全局CI变量或某条流水线的CI变量，以便之后开发人员在添加流水线CI任务时引用。
* 流水线-构建类型任务-高级设置中，新增共享目录设置的功能，支持同一流水线中的构建任务在共享目录中上传或下载产生的工件或其他文件内容。
* 流水线中新增Runner配置的指引界面。
* 项目成员新增支持更多的GitLab权限，包括：Guest、Reporter、Developer和Maintainer，且拥有不同GitLab权限的项目成员在应用服务、代码管理、CI流水线菜单下的操作权限不同，从而使项目成员角色能适应更多的项目开发与管理场景。
* 项目所有者在应用服务模块中修改应用服务时，支持选择项目层已有的自定义Docker仓库。
## 功能优化

* 流水线docker构建步骤中新增设置是否进行证书校验，用于解决自签名证书校验不通过的问题。
## 缺陷修复

* 修复了CI流水线中，项目成员没有应用服务的权限，可以看到该服务对应的CI流水线的问题。
* 修复了组织管理员同时拥有项目成员角色, 被删除组织管理员角色后, 项目层应用服务权限不正常的问题。
## 移除

* 移除了应用服务详情中“权限分配”Tab页面，点击权限管理按钮后，将跳转至代码库管理页面。

# 环境部署 

### [0.23.0] - 2020-10-12

## 新增功能

* PV管理中新增LocalPV类型的PV
## 缺陷修复

* 修复了无法收到资源删除验证的通知的问题
* 修复了流水线执行记录页面中部署任务的生成实例显示问题
* 修复了停用Pod之后，还能增减Pod数量的问题
* 修复了一次部署可能产生多条部署记录的问题
* 修复了实例的唯一性校验为全局唯一的问题，改为了集群下唯一
* 修复了同名版本生成时更新了chart包但是没有更新数据库values内容的问题
## 功能优化

* 在集群中安装监控组件时，增加“是否安装https”的选项，且默认为否，用以解决集群未安装证书时，监控组件无法使用的问题
* 优化了chart包的values文件获取，目前使用广度优先搜索， 多个层级包含values文件时， 会取最高层
* 优化了Pod数量置为1后，不能再降为0的提示；此时，鼠标hover至灰色的减少Pod的角标后，显示出：若想降至0，请直接点击“停用实例”
* 优化了流水线中创建部署任务时自动填充实例名称的步骤
* 优化了部署配置的创建步骤，没有生成过版本的应用服务也能创建部署配置

# 制品库

### [0.23.0] - 2020-10-12

## 新增功能

* 制品库管理：创建制品库(docker、maven、npm)、自定义harbor仓库、自定义nexus服务、仓库总览、镜像/包列表管理、用户权限管理、操作日志等功能
* 平台层新增"制品库管理"模块，包括为默认的nexus服务上，已有仓库的分配功能
* 自定义nexus服务功能: 支持添加默认外自己安装的nexus服务。创建maven/npm仓库时，是在对应启用的nexus服务下
* 创建制品库功能: 支持在当前项目下创建/更新制品仓库
* 镜像/包管理功能: 支持查看与发布仓库下镜像/包列表
* 用户权限功能: 支持管理项目成员对该仓库的权限
* 操作日志功能: 记录了权限分配/镜像操作的操作日志
* 制品库账号：查询默认密码、修改密码

# 代码库

### [0.23.0] - 2020-10-12

## 新增功能

* 项目层新增"代码库管理"模块，包括权限分配、权限申请/审批、权限审计、安全审计、保护分支/标记、操作日志、总览等功能
* 组织层新增"代码库管理"模块，包括权限分配、权限审计、操作日志等功能
* 权限分配功能支持查看和分配团队成员的代码库权限
* 权限申请功能支持向项目管理员申请应用服务的权限
* 权限审计功能支持定时审计代码库与Gitlab权限不一致的数据, 并支持修复不一致权限
* 安全审计功能支持查看团队成员的权限分布情况
* 保护分支/标记支持查看和设置保护分支和保护标记, 用于对分支(branches)和标记(tags)的权限进行设置
* 操作日志功能记录了权限分配的操作日志
* 总览功能支持查看各应用服务的一些信息
 